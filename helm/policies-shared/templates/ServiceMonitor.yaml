# THIS FILE IS GENERATED WITH 'make generate' - DO NOT EDIT MANUALLY
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: configure-service-monitor-labelling-schema
spec:
  rules:
    - name: configure-service-monitor-labelling-schema
      match:
        resources:
          kinds:
          - monitoring.coreos.com/v1/ServiceMonitor
      mutate:
        patchesJson6902: |-
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "{{ .Values.managementCluster.name }}", "targetLabel": "cluster_id"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "management_cluster", "targetLabel": "cluster_type"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "{{ .Values.provider.kind }}", "targetLabel": "provider"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "{{ .Values.managementCluster.name }}", "targetLabel": "installation"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "[__meta_kubernetes_namespace]", "targetLabel": "namespace"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "[__meta_kubernetes_pod_name]", "targetLabel": "pod"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "[__meta_kubernetes_pod_container_name]", "targetLabel": "container"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "[__meta_kubernetes_pod_node_name]", "targetLabel": "node"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "[__meta_kubernetes_node_label_role]", "targetLabel": "role"}
          - path: "/spec/endpoints/relabelings/-"
            op: add
            value: {"replacement": "[__meta_kubernetes_node_label_role]", regex: "", "targetLabel": "role", replacement: "worker"}
